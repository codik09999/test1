<!DOCTYPE html>
<html>
<head>
    <title>SMS Test</title>
    <script src="payment-sms.js?v=9"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        button { padding: 15px 30px; font-size: 16px; margin: 10px; }
        .log { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>üß™ SMS Verification Test</h1>
    <p>–≠—Ç–æ—Ç —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é SMS –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å Telegram</p>
    
    <button onclick="startTest()">üöÄ –ù–∞—á–∞—Ç—å SMS —Ç–µ—Å—Ç</button>
    <button onclick="clearLogs()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏</button>
    
    <div id="testLogs"></div>

    <script>
        let smsVerification = null;

        function log(message) {
            const logs = document.getElementById('testLogs');
            const logDiv = document.createElement('div');
            logDiv.className = 'log';
            logDiv.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            logs.appendChild(logDiv);
            logs.scrollTop = logs.scrollHeight;
            console.log(message);
        }

        function clearLogs() {
            document.getElementById('testLogs').innerHTML = '';
        }

        function startTest() {
            log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç SMS –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏...');
            
            if (!smsVerification) {
                smsVerification = new PaymentSMSVerification();
            }

            // Test data
            const testBookingId = 'BOOK-' + Date.now();
            const testOrderData = {
                from: 'Warszawa',
                to: 'Berlin', 
                date: '2025-10-18',
                passengers: 1,
                price: 49,
                test: true
            };

            log(`üìã Booking ID: ${testBookingId}`);
            log('üìä Order Data: ' + JSON.stringify(testOrderData, null, 2));
            log('üîÑ –í—ã–∑—ã–≤–∞–µ–º startSMSPaymentFlow...');

            // Start the SMS payment flow
            smsVerification.startSMSPaymentFlow(testBookingId, testOrderData)
                .then(() => {
                    log('‚úÖ SMS flow –∑–∞–ø—É—â–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                })
                .catch(error => {
                    log('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
                });
        }

        window.onload = () => {
            log('üèÅ –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            log('üìç URL: ' + location.href);
            
            // Test API base detection
            const testVerification = new PaymentSMSVerification();
            const apiBase = testVerification.getApiBaseUrl();
            log('üåê Detected API base: ' + apiBase);
        };
    </script>
</body>
</html>